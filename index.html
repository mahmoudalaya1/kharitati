<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø®Ø±ÙŠØ·ØªÙŠ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
  body { margin:0; font-family: Arial, sans-serif; }
  #map { height:100vh; }
.panel {
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 9999;
  background: white;
  padding: 10px;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,.3);
  width: 220px;
}

  .panel input {
    width:100%;
    padding:6px;
    margin-bottom:6px;
  }
  .panel button {
    width:100%;
    padding:7px;
    background:#2196f3;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
  }
</style>
</head>
<body>

<div class="panel">
  <input id="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙƒØ§Ù†">
  <button onclick="searchPlace()">ğŸ” Ø¨Ø­Ø«</button>
  <button style="margin-top:5px" onclick="locateMe()">ğŸ“ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
</div>
<button class="btn" style="top:70px; right:10px;" onclick="savePlace()">â­ Ø­ÙØ¸ Ø§Ù„Ù…ÙƒØ§Ù†</button>
<button class="btn-save">â­ Ø²Ø± Ø§Ø®ØªØ¨Ø§Ø±</button>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
  const map = L.map('map').setView([33.5138, 36.2765], 6);
  let marker;

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    attribution:'Â© OpenStreetMap'
  }).addTo(map);

  function locateMe(){
    navigator.geolocation.getCurrentPosition(pos=>{
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      map.setView([lat, lon], 15);
      if(marker) map.removeLayer(marker);
      marker = L.marker([lat, lon]).addTo(map).bindPopup("ğŸ“ Ù…ÙˆÙ‚Ø¹Ùƒ").openPopup();
    }, ()=> alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹"));
  }

  function searchPlace(){
    const q = document.getElementById("search").value;
    if(!q) return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØ§Ù†");

    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${q}`)
      .then(res => res.json())
      .then(data => {
        if(data.length === 0){
          alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§Ù†");
          return;
        }
        const lat = data[0].lat;
        const lon = data[0].lon;
        map.setView([lat, lon], 14);
        if(marker) map.removeLayer(marker);
        marker = L.marker([lat, lon]).addTo(map)
          .bindPopup(data[0].display_name)
          .openPopup();
      });
  }
</script>

</body>
</html>

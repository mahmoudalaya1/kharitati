<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  font-family: Arial;
  background:#eee;
}
.box{
  width:300px;
  margin:100px auto;
  background:#fff;
  padding:20px;
  border-radius:6px;
  text-align:center;
}
input,button{
  width:100%;
  padding:10px;
  margin:6px 0;
}
button{
  background:#1976d2;
  color:#fff;
  border:none;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="box">
  <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
  <input id="name" placeholder="Ø§Ù„Ø§Ø³Ù…">
  <input id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
  <input id="password" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

  <button onclick="register()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
  <button onclick="resetPassword()">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getAuth,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  sendPasswordResetEmail
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

/* ðŸ”¥ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase */
const firebaseConfig = {
  apiKey: "AIzaSyDr5hql0t0eI0AYi7-_xLZfYpFw8F6vXRA",
  authDomain: "kharitati-5cb37.firebaseapp.com",
  projectId: "kharitati-5cb37",
  appId: "1:296218682746:web:650a1161841ea510eea2c3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

/* ðŸ§  Ø£Ø¯ÙˆØ§Øª */
const emailVal = () => document.getElementById("email").value.trim();
const passVal  = () => document.getElementById("password").value.trim();
const nameVal  = () => document.getElementById("name").value.trim();

/* ðŸ†• Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ */
window.register = () => {
  if(!nameVal() || !emailVal() || !passVal()){
    alert("Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„");
    return;
  }

  createUserWithEmailAndPassword(auth, emailVal(), passVal())
    .then(()=>{
      alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
      window.location.href = "map.html";
    })
    .catch(e=>alert(e.message));
};

/* ðŸ”‘ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ */
window.login = () => {
  if(!emailVal() || !passVal()){
    alert("Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");
    return;
  }

  signInWithEmailAndPassword(auth, emailVal(), passVal())
    .then(()=>{
      alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„");
      window.location.href = "map.html";
    })
    .catch(e=>alert(e.message));
};

/* ðŸ” Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± */
window.resetPassword = () => {
  if(!emailVal()){
    alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£ÙˆÙ„Ø§Ù‹");
    return;
  }

  sendPasswordResetEmail(auth, emailVal())
    .then(()=>alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†"))
    .catch(e=>alert(e.message));
};
</script>

</body>
</html>
